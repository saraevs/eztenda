<div class="listing-deal-show">
  <h2><%= @listing_deal.user.name %></h2>
  <h3>Details</h3>
    <ul>
        <li>Product: <%= @product.name %></li>
        <li>Category: <%= @product.category %></li>
        <li>Volume Required: <%= @listing_deal.volume %></li>
        <li>Start Date: <%= @listing_deal.start_date.strftime("%a %e %b %y") %></li>
        <li>End Date: <%= @listing_deal.end_date.strftime("%a %e %b %y") %></li>
        <li>Minimum Bid: £<%= @listing_deal.min_amount %></li>
        <li>Other Requirements: <%= @listing_deal.other_requirements %></li>
      </ul>
  <div class="listing-deals-bids">
    <% if @listing_deal.bids.pluck('accepted').include?(true) %>
      <div class="accepted-bid-card">
        <p>A bid has been accepted for this tender!</p>
      </div>
    <% else %>
      <div class="listing-deal-bid-form">
        <% if current_user.is_venue == false %>
          <h3>Place a bid</h3>
          <%= render "./bids/new" %>
        <% end %>
      </div>
      <div class="bid-card">
        <h3>All Bids</h3>
        <% @bids.order(:amount).reverse.each do |bid| %>
          <ul>
            <li>Brand: <%= bid.user.name %></li>
            <li>Product: <%= bid.product.name %></li>
            <li>Offer: £<%= bid.amount %></li>
          </ul>
          <!-- this isn't funtional as don't have a route. can be replaced by Sara's bid form/show -->
          <% if current_user == @listing_deal.user %>
            <%= link_to 'Accept this bid' %>
          <% end %>
         <% end %>
        </div>
      <% end %>
  </div>
  <div class="listing-deal-show-actions">
    <% if current_user.id == @listing_deal.user.id %>
      <%= link_to 'Edit this listing', edit_listing_deal_path(@listing_deal.id) %>
      <%= link_to 'Delete this listing', listing_deal_path(@listing_deal.id), method: :delete, data: { confirm: 'Are you sure?'} %>
    <% end %>
    <%= link_to 'Back to all Listings', listing_deals_path %>
  </div>
</div>

